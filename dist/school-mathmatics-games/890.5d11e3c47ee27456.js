"use strict";(self.webpackChunkSchoolMathmaticsGames=self.webpackChunkSchoolMathmaticsGames||[]).push([[890],{1890:(ee,f,o)=>{o.r(f),o.d(f,{GamePageModule:()=>L});var g=o(6895),h=o(1658),l=o(7340),_=o(8212),v=o(4354),x=o(9751),y=o(727);class C extends y.w0{constructor(a,t){super()}schedule(a,t=0){return this}}const m={setInterval(n,a,...t){const{delegate:s}=m;return s?.setInterval?s.setInterval(n,a,...t):setInterval(n,a,...t)},clearInterval(n){const{delegate:a}=m;return(a?.clearInterval||clearInterval)(n)},delegate:void 0};var b=o(8737);const p={now:()=>(p.delegate||Date).now(),delegate:void 0};class u{constructor(a,t=u.now){this.schedulerActionCtor=a,this.now=t}schedule(a,t=0,s){return new this.schedulerActionCtor(this,a).schedule(s,t)}}u.now=p.now;const M=new class P extends u{constructor(a,t=u.now){super(a,t),this.actions=[],this._active=!1}flush(a){const{actions:t}=this;if(this._active)return void t.push(a);let s;this._active=!0;do{if(s=a.execute(a.state,a.delay))break}while(a=t.shift());if(this._active=!1,s){for(;a=t.shift();)a.unsubscribe();throw s}}}(class w extends C{constructor(a,t){super(a,t),this.scheduler=a,this.work=t,this.pending=!1}schedule(a,t=0){var s;if(this.closed)return this;this.state=a;const i=this.id,r=this.scheduler;return null!=i&&(this.id=this.recycleAsyncId(r,i,t)),this.pending=!0,this.delay=t,this.id=null!==(s=this.id)&&void 0!==s?s:this.requestAsyncId(r,this.id,t),this}requestAsyncId(a,t,s=0){return m.setInterval(a.flush.bind(a,this),s)}recycleAsyncId(a,t,s=0){if(null!=s&&this.delay===s&&!1===this.pending)return t;null!=t&&m.clearInterval(t)}execute(a,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const s=this._execute(a,t);if(s)return s;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(a,t){let i,s=!1;try{this.work(a)}catch(r){s=!0,i=r||new Error("Scheduled action threw falsy error")}if(s)return this.unsubscribe(),i}unsubscribe(){if(!this.closed){const{id:a,scheduler:t}=this,{actions:s}=t;this.work=this.state=this.scheduler=null,this.pending=!1,(0,b.P)(s,this),null!=a&&(this.id=this.recycleAsyncId(t,a,null)),this.delay=null,super.unsubscribe()}}});var k=o(3532);var O=o(3900),A=o(2723),I=o(4763),G=o(4207),e=o(8256),Q=o(4729),d=o(5638),E=o(6726);let j=(()=>{class n{constructor(t){this.element=t}ngOnInit(){let t=parseInt(this.value);this.element.nativeElement.style.backgroundColor=t<=0?"#DA0303":t>0?"#68A153":"white"}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.SBq))},n.\u0275dir=e.lG2({type:n,selectors:[["","appChangeColor",""]],inputs:{value:["appChangeColor","value"]}}),n})(),B=(()=>{class n{transform(t,...s){let i=Math.floor(t/3600),r=Math.floor((t-3600*i)/60),c=t-3600*i-60*r;return`${i<10?"0":""}${i}:${r<10?"0":""}${r}:${c<10?"0":""}${c}`}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275pipe=e.Yjl({name:"time",type:n,pure:!0}),n})();const J=["teamRef"],R=["sumRef"];function U(n,a){1&n&&(e.ynx(0),e.TgZ(1,"div",19),e._uU(2," \u041d\u0435 \u043d\u0430\u0447\u0430\u043b\u0430\u0441\u044c "),e.qZA(),e.BQk()),2&n&&(e.xp6(1),e.Q6J("@appear",void 0)("@leave",void 0))}function D(n,a){1&n&&(e.ynx(0),e.TgZ(1,"div",20),e._uU(2," \u0418\u0434\u0451\u0442 "),e.qZA(),e.BQk()),2&n&&(e.xp6(1),e.Q6J("@appear",void 0)("@leave",void 0))}function Y(n,a){1&n&&(e.ynx(0),e.TgZ(1,"div",21),e._uU(2," \u041f\u0440\u0438\u043e\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0430 "),e.qZA(),e.BQk()),2&n&&(e.xp6(1),e.Q6J("@appear",void 0)("@leave",void 0))}function z(n,a){1&n&&(e.ynx(0),e.TgZ(1,"div",22),e._uU(2," \u0417\u0430\u043c\u043e\u0440\u043e\u0436\u0435\u043d\u0430 "),e.qZA(),e.BQk()),2&n&&(e.xp6(1),e.Q6J("@appear",void 0)("@leave",void 0))}function S(n,a){1&n&&(e.ynx(0),e.TgZ(1,"div",23),e._uU(2," \u0417\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0430 "),e.qZA(),e.BQk()),2&n&&(e.xp6(1),e.Q6J("@appear",void 0)("@leave",void 0))}function N(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"div",24),e._uU(2),e.qZA(),e.BQk()),2&n){const t=a.$implicit;e.xp6(2),e.hij(" ",t," ")}}function F(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"div",28),e._uU(2),e.qZA(),e.BQk()),2&n){const t=a.$implicit,s=a.index,i=e.oxw(3);e.xp6(1),e.Q6J("appChangeColor",i.Converters.convertResponse(t,i.game.type,!1,s)),e.xp6(1),e.hij(" ",i.Converters.convertResponse(t,i.game.type,!1,s)," ")}}function $(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"div",25)(2,"div",26,15),e._uU(4),e.qZA(),e.TgZ(5,"div",27,17),e._uU(7),e.qZA(),e.YNc(8,F,3,2,"ng-container",18),e.qZA(),e.BQk()),2&n){const t=a.$implicit;e.xp6(4),e.hij(" ",t.name," "),e.xp6(3),e.hij(" ",t.sumScore," "),e.xp6(1),e.Q6J("ngForOf",t.scores)}}function V(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"div",3)(2,"h2",4),e._uU(3),e.TgZ(4,"div",5),e._uU(5),e.qZA()(),e.TgZ(6,"div",6)(7,"div",7)(8,"div",8),e._uU(9),e.ALo(10,"time"),e.qZA()(),e.TgZ(11,"div",9),e.YNc(12,U,3,2,"ng-container",10),e.YNc(13,D,3,2,"ng-container",10),e.YNc(14,Y,3,2,"ng-container",10),e.YNc(15,z,3,2,"ng-container",10),e.YNc(16,S,3,2,"ng-container",10),e.qZA()(),e.TgZ(17,"div",11)(18,"div",12)(19,"div",13)(20,"div",14,15),e._uU(22," \u041a\u043e\u043c\u0430\u043d\u0434\u0430 "),e.qZA(),e.TgZ(23,"div",16,17),e._uU(25," \u0421\u0443\u043c\u043c\u0430 "),e.qZA(),e.YNc(26,N,3,1,"ng-container",18),e.qZA(),e.YNc(27,$,9,3,"ng-container",18),e.qZA()()(),e.BQk()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("@appear",void 0)("@leave",void 0),e.xp6(2),e.hij(" ",t.game.name," "),e.xp6(2),e.hij(" / ",t.OGameType[t.game.type]," "),e.xp6(4),e.hij(" ",e.lcZ(10,12,t.game.time)," "),e.xp6(3),e.Q6J("ngIf",0==t.game.status),e.xp6(1),e.Q6J("ngIf",1==t.game.status),e.xp6(1),e.Q6J("ngIf",2==t.game.status),e.xp6(1),e.Q6J("ngIf",3==t.game.status),e.xp6(1),e.Q6J("ngIf",4==t.game.status),e.xp6(10),e.Q6J("ngForOf",t.GameExercises.getExercises(t.game.type)),e.xp6(1),e.Q6J("ngForOf",t.game.teams)}}function X(n,a){1&n&&(e.TgZ(0,"div",29),e._UZ(1,"img",30),e.qZA()),2&n&&e.Q6J("@appear",void 0)("@leave",void 0)}let q=(()=>{class n{constructor(t,s,i){this._gamesService=t,this._router=s,this._destroy=i,this.time="",this.OGameType=A.E,this.GameExercises=I.E,this.Converters=G.R,this.isTeamsChecked=!1}ngOnInit(){(function Z(n=0,a,t=M){let s=-1;return null!=a&&((0,k.K)(a)?t=a:s=a),new x.y(i=>{let r=function T(n){return n instanceof Date&&!isNaN(n)}(n)?+n-t.now():n;r<0&&(r=0);let c=0;return t.schedule(function(){i.closed||(i.next(c++),0<=s?this.schedule(void 0,s):i.complete())},r)})})(0,7e3).pipe((0,O.w)(()=>this._gamesService.getGameById(parseInt(this._router.url.split("/").reverse()[0])))).pipe(this._destroy.takeUntilDestroy).subscribe(t=>{if(!this.game)return this.game=t,this.checkTeamsView(),void this.remakeInterval();this.checkResponse(t),this.checkTeamsView()})}remakeInterval(){clearInterval(this.interval),1==this.game.status&&(this.interval=setInterval(()=>{this.game.time-=1},1e3))}checkResponse(t){this.game.name!=t.name&&(this.game.name=t.name),this.game.status!=t.status&&(this.game.status=t.status,this.game.time=t.time),this.remakeInterval(),t.teams.forEach((s,i)=>{s.scores.forEach((r,c)=>{this.game.teams[i].scores[c]!=r&&(this.game.teams[i].scores[c]=r)}),this.game.teams[i].sumScore!=s.sumScore&&(this.game.teams[i].sumScore=s.sumScore)})}checkTeamsView(){this.isTeamsChecked||(this.isTeamsChecked=!0,setTimeout(()=>{let t=0;this.teamRef.forEach(s=>t=Math.max(t,s.nativeElement.getBoundingClientRect().width)),this.teamRef.forEach(s=>s.nativeElement.style.width=t+"px"),this.sumRef.forEach(s=>s.nativeElement.style.left=t+"px")},100))}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(Q.B),e.Y36(d.F0),e.Y36(h.z))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-game-page"]],viewQuery:function(t,s){if(1&t&&(e.Gf(J,5),e.Gf(R,5)),2&t){let i;e.iGM(i=e.CRH())&&(s.teamRef=i),e.iGM(i=e.CRH())&&(s.sumRef=i)}},features:[e._Bn([h.z])],decls:5,vars:4,consts:[[1,"game"],[4,"ngIf","ngIfElse"],["loading",""],[1,"game__wrapper"],[1,"game__name"],[1,"game__type"],[1,"game__row"],[1,"game__rest","game-rest"],[1,"game-rest__container"],[1,"game__buttons"],[4,"ngIf"],[1,"game__results-wrap"],[1,"game__results","game-results"],[1,"game-results__row","game-results__row-head"],[1,"game-results__team-head"],["teamRef",""],[1,"game-results__sum-head"],["sumRef",""],[4,"ngFor","ngForOf"],[1,"game__button"],[1,"game__button","game__button-ok"],[1,"game__button","game__button-pause"],[1,"game__button","game__button-frozen"],[1,"game__button","game__button-stop"],[1,"game-results__score-head"],[1,"game-results__row"],[1,"game-results__team"],[1,"game-results__sum"],[1,"game-results__score",3,"appChangeColor"],[1,"loader"],["src","assets/icons/loader-black.svg","alt",""]],template:function(t,s){if(1&t&&(e.TgZ(0,"section",0),e._UZ(1,"app-back-to-main"),e.YNc(2,V,28,14,"ng-container",1),e.YNc(3,X,2,2,"ng-template",null,2,e.W1O),e.qZA()),2&t){const i=e.MAs(4);e.Q6J("@appear",void 0)("@leave",void 0),e.xp6(2),e.Q6J("ngIf",s.game)("ngIfElse",i)}},dependencies:[g.sg,g.O5,E.q,j,B],styles:[".game[_ngcontent-%COMP%]{min-height:100vh;background-color:#fff;display:flex;flex-direction:column;padding:2.4rem 4.5rem}@media (max-width: 768px){.game[_ngcontent-%COMP%]{padding:2.4rem 2rem}}@media (max-width: 500px){.game[_ngcontent-%COMP%]{padding:2.4rem 1.5rem}}.game__wrapper[_ngcontent-%COMP%]{flex-grow:1;display:flex;flex-direction:column;align-items:center;height:100%;width:100%}.game__name[_ngcontent-%COMP%]{font-weight:700;font-size:1.6rem;display:flex;flex-wrap:wrap;align-items:center;justify-content:center;gap:.7rem;width:100%;padding-left:3rem;word-wrap:anywhere;text-align:center}@media (max-width: 500px){.game__name[_ngcontent-%COMP%]{padding-left:3.5rem}}.game__type[_ngcontent-%COMP%]{color:#6b6b6b}.game__row[_ngcontent-%COMP%]{margin-top:2rem;display:flex;align-items:center;justify-content:space-between;width:100%;gap:1.5rem}.game__rest[_ngcontent-%COMP%]{margin-left:15%}@media (max-width: 500px){.game__rest[_ngcontent-%COMP%]{margin-left:0}}.game__buttons[_ngcontent-%COMP%]{display:flex;gap:1.2rem;justify-content:flex-end}.game__button[_ngcontent-%COMP%]{background-color:#6b6b6b;color:#fff;padding:1.2rem 1.8rem;border-radius:11px;font-size:1.8rem;font-weight:700;transition:all ease .3s}.game__button-save[_ngcontent-%COMP%]{background-color:#454b7e}.game__button-ok[_ngcontent-%COMP%]{background-color:#68a153}.game__button-pause[_ngcontent-%COMP%]{background-color:#be8632}.game__button-frozen[_ngcontent-%COMP%]{background-color:#536ea1}.game__button-stop[_ngcontent-%COMP%]{background-color:#da0303}.game__results-wrap[_ngcontent-%COMP%]{margin-top:2rem;width:100%}.game__results[_ngcontent-%COMP%]{overflow-x:scroll;padding-bottom:1rem}.game__results-wrap[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:center}.game-rest[_ngcontent-%COMP%]{padding:.5rem .9rem;background-color:#f0f0f0;border-radius:11px}.game-rest__container[_ngcontent-%COMP%]{color:#3290ff;font-weight:700;font-size:2.5rem}.game-results__row[_ngcontent-%COMP%]{display:flex;width:-moz-fit-content;width:fit-content}.game-results__row-head[_ngcontent-%COMP%]{position:sticky;z-index:3;top:-3rem}.game-results__team-head[_ngcontent-%COMP%]{border:1px solid black;display:flex;justify-content:center;align-items:center;position:sticky;left:0;top:0;background-color:#e5e5e5;z-index:2;padding:.7rem}.game-results__sum-head[_ngcontent-%COMP%]{width:5rem;height:3rem;border:1px solid black;border-left:none;display:flex;justify-content:center;align-items:center;position:sticky;background-color:#e5e5e5;z-index:2}.game-results__score-head[_ngcontent-%COMP%]{width:3.5rem;height:3rem;border:1px solid black;border-left:none;display:flex;justify-content:center;align-items:center;background-color:#e5e5e5;position:sticky;top:0}.game-results__team[_ngcontent-%COMP%]{border:1px solid black;border-top:none;display:flex;justify-content:center;align-items:center;padding:.7rem;position:sticky;left:0;white-space:nowrap;background-color:#e5e5e5}.game-results__sum[_ngcontent-%COMP%]{width:5rem;height:3rem;text-align:center;border:1px solid black;border-top:none;border-left:none;display:flex;justify-content:center;align-items:center;position:sticky;background-color:#fff}.game-results__score[_ngcontent-%COMP%]{width:3.5rem;height:3rem;border:1px solid black;border-top:none;border-left:none;display:flex;align-items:center;justify-content:center;color:#fff}"],data:{animation:[(0,l.X$)("appear",[(0,l.eR)(":enter",(0,l._7)(_.M))]),(0,l.X$)("leave",[(0,l.eR)(":leave",(0,l._7)(v.Z))])]}}),n})();var H=o(4466),W=o(433);const K=[{path:"",component:q}];let L=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[g.ez,d.Bz.forChild(K),H.m,W.UX,d.Bz]}),n})()}}]);