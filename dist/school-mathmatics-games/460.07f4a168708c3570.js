"use strict";(self.webpackChunkSchoolMathmaticsGames=self.webpackChunkSchoolMathmaticsGames||[]).push([[460],{8460:(oe,M,u)=>{u.r(M),u.d(M,{EditPageModule:()=>ne});var m=u(6895),g=u(1658),c=u(7340),b=u(8212),C=u(4354),p=u(5698),e=u(8256),f=u(5638),x=u(4729),s=u(433),O=u(6726),T=u(8249);function P(a,r){if(1&a){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",34),e.NdJ("click",function(o){e.CHM(t);const i=e.oxw(2).index,_=e.oxw();return e.KtG(_.updateTeam(i,o))}),e._UZ(2,"img",35)(3,"img",32),e.qZA(),e.TgZ(4,"button",36),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2).index,i=e.oxw();return e.KtG(i.cancelUpdate(o))}),e._uU(5," \u041e\u0442\u043c\u0435\u043d\u0430 "),e.qZA(),e.BQk()}2&a&&(e.xp6(1),e.Q6J("@appear",void 0)("@leave",void 0),e.xp6(3),e.Q6J("@appear",void 0)("@leave",void 0))}function Z(a,r){if(1&a){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",30),e.NdJ("click",function(o){e.CHM(t);const i=e.oxw().index,_=e.oxw();return e.KtG(_.deleteTeam(i,o))}),e._UZ(2,"img",31)(3,"img",32),e.qZA(),e.YNc(4,P,6,4,"ng-container",33),e.BQk()}if(2&a){const t=e.oxw(),n=t.$implicit,o=t.index,i=e.oxw();e.xp6(1),e.Q6J("@appear",void 0),e.xp6(3),e.Q6J("ngIf",n.controls.name.value!=i.teams[o].name)}}function E(a,r){if(1&a){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",37),e.NdJ("click",function(o){e.CHM(t);const i=e.oxw(3);return e.KtG(i.addTeam(o))}),e._UZ(2,"img",35)(3,"img",32),e.qZA(),e.BQk()}2&a&&(e.xp6(1),e.Q6J("@appear",void 0))}function S(a,r){if(1&a&&e.YNc(0,E,4,1,"ng-container",33),2&a){const t=e.oxw().$implicit;e.Q6J("ngIf",""!=t.controls.name.value)}}function A(a,r){if(1&a&&(e.ynx(0),e.TgZ(1,"li",24)(2,"div",25),e._UZ(3,"input",26),e.qZA(),e.TgZ(4,"div",27),e.YNc(5,Z,5,2,"ng-container",28),e.YNc(6,S,1,1,"ng-template",null,29,e.W1O),e.qZA()(),e.BQk()),2&a){const t=r.$implicit,n=r.index,o=e.MAs(7),i=e.oxw();e.xp6(1),e.Q6J("@appear",void 0)("@leave",void 0),e.xp6(2),e.Q6J("formControl",t.controls.name),e.xp6(2),e.Q6J("ngIf",n!=i.teamsControls.controls.length-1)("ngIfElse",o)}}const k=function(a){return{invalid:a}},G=function(a){return{disabled:a}};let F=(()=>{class a{constructor(t,n,o,i,_){this._router=t,this._gamesService=n,this._destroy=o,this._fb=i,this._confirmer=_,this.changeStatusEvent=new e.vpe,this.deleteEvent=new e.vpe,this.teams=[],this.disableGameForm=!0,this.counter=-1}ngOnInit(){this.parseGame(this.game),this.gameForm.valueChanges.pipe(this._destroy.takeUntilDestroy).subscribe(()=>{this.disableGameForm=!1})}get teamsControls(){return this.teamForm.controls.teams}initTeams(t){this.teamForm=this._fb.group({teams:this._fb.array([])}),t.teams.forEach(n=>this.teamsControls.push(this.initTeam(n))),this.teamsControls.push(this.initTeam()),this.teams=t.teams}initTeam(t){return this._fb.group({name:new s.NI(t?.name??"",{nonNullable:!0}),id:new s.NI(t?.teamId??--this.counter,{nonNullable:!0})})}addTeam(t){if(t.target.classList.contains("loading"))return;t.target.classList.add("loading");let n=this.teamsControls.at(this.teamsControls.length-1);n.disable(),this._gamesService.addTeam({gameId:this.game.id,name:n.controls.name.value}).pipe((0,p.q)(1)).subscribe(o=>{n.controls.id.setValue(o.teamId),this.teams.push(o),t.target.classList.remove("loading"),n.enable(),this.teamsControls.push(this.initTeam())})}deleteTeam(t,n){this._confirmer.createConfirm("\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u043a\u043e\u043c\u0430\u043d\u0434\u0443?").subscribe(o=>{if(!o||n.target.classList.contains("loading"))return;n.target.classList.add("loading");let i=this.teamsControls.at(t);i.disable(),this._gamesService.deleteTeam({gameId:this.game.id,teamId:i.controls.id.value}).pipe((0,p.q)(1)).subscribe(_=>{let l=this.teamsControls;for(let d=0;d<l.length;d++)if(l.at(d).controls.id.value==_.teamId){l.removeAt(d),this.teams.splice(this.teams.findIndex(h=>h.teamId==_.teamId),1);break}})})}updateTeam(t,n){if(n.target.classList.contains("loading"))return;n.target.classList.add("loading");let o=this.teamsControls.at(t);o.disable(),this._gamesService.updateTeam({gameId:this.game.id,teamId:o.controls.id.value,name:o.controls.name.value}).pipe((0,p.q)(1)).subscribe(_=>{let l=this.teams.find(d=>d.teamId==_.teamId);!l||(l.name=_.name,o.enable())})}cancelUpdate(t){let n=this.teamsControls.at(t),o=this.teams.find(i=>i.teamId==n.controls.id.value);o&&n.controls.name.setValue(o.name)}parseGame(t){const n=new Date(t.start);this.gameForm=new s.cw({gameTitle:new s.NI(t.name,{validators:[s.kI.required],nonNullable:!0}),date:new s.NI(this.parseDate(n),{nonNullable:!0,validators:[s.kI.required,o=>{const i=o.value.toString().split(".").reverse().join("-"),_=Date.parse(i);return isNaN(+_)?{invalidDate:!0}:null}]}),time:new s.NI(this.parseTime(n),{nonNullable:!0}),timeGame:new s.NI(this.parseTimeGame(t.time),{nonNullable:!0})}),this.initTeams(t),this.game=t}parseTimeGame(t){const n=Math.floor(t/3600),o=Math.floor((t-3600*n)/60);return`${n<10?"0":""}${n}:${o<10?"0":""}${o}`}parseDate(t){return`${t.getFullYear()}-${t.getMonth()<9?"0":""}${t.getMonth()+1}-${t.getDate()<10?"0":""}${t.getDate()}`}parseTime(t){return`${t.getHours()<10?"0":""}${t.getHours()}:${t.getMinutes()<10?"0":""}${t.getMinutes()}`}startGame(){this._confirmer.createConfirm("\u041d\u0430\u0447\u0430\u0442\u044c \u0438\u0433\u0440\u0443?").subscribe(t=>{!t||this.changeStatusEvent.emit(1)})}deleteGame(){this._confirmer.createConfirm("\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0438\u0433\u0440\u0443?").subscribe(t=>{!t||this.deleteEvent.emit(1)})}updateGame(){if(this.gameForm.invalid||this.gameForm.disabled)return void this.gameForm.markAsTouched();this.gameForm.disable();let t={gameId:this.game.id,name:this.gameForm.controls.gameTitle.value,timeGame:this.codeTime(this.gameForm.controls.timeGame.value),start:Date.parse(this.gameForm.controls.date.value+"T"+this.gameForm.controls.time.value)};setTimeout(()=>this.disableGameForm=!0,10),this._gamesService.updateGame(t).subscribe(()=>{this.game.name=t.name,this.game.time=t.timeGame,this.game.start=new Date(t.start),this.gameForm.enable(),setTimeout(()=>this.disableGameForm=!0,10)})}codeTime(t){let n=t.split(":");return 3600*parseInt(n[0])+60*parseInt(n[1])}resetGame(){if(this.gameForm.disabled)return;let t=new Date(this.game.start);this.gameForm.controls.gameTitle.setValue(this.game.name),this.gameForm.controls.date.setValue(this.parseDate(t)),this.gameForm.controls.time.setValue(this.parseTime(t)),this.gameForm.controls.timeGame.setValue(this.parseTimeGame(this.game.time)),this.gameForm.enable(),setTimeout(()=>{this.disableGameForm=!0},10)}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(f.F0),e.Y36(x.B),e.Y36(g.z),e.Y36(s.qu),e.Y36(T.z))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-before-started"]],inputs:{game:"game"},outputs:{changeStatusEvent:"changeStatusEvent",deleteEvent:"deleteEvent"},features:[e._Bn([g.z])],decls:36,vars:16,consts:[[1,"edit__title","title-page"],["action","",1,"edit__form","edit-form",3,"formGroup"],[1,"edit-form__name"],["type","text","placeholder","\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u0438\u0433\u0440\u044b",1,"edit-form__name-input",3,"formControl","ngClass"],[1,"edit-form__row"],[1,"edit-form__field"],[1,"edit-form__field-title"],[1,"edit-form__date-row"],[1,"edit-form__input-wrap",3,"ngClass"],["type","date","onClick","event.preventDefault()",1,"edit-form__input-date",3,"formControl"],[1,"edit-form__input-wrap","time"],["type","time",1,"edit-form__input-time",3,"formControl"],["type","time","onClick","event.preventDefault()",1,"edit-form__input-time",3,"formControl"],[1,"edit-form__buttons",3,"ngClass"],[1,"edit-form__button","edit-form__button-cancel",3,"click"],[1,"edit-form__button","edit-form__button-submit",3,"click"],[1,"edit__teams","edit-teams"],[1,"edit-teams__title"],[1,"edit-teams__controls"],[4,"ngFor","ngForOf"],[1,"edit__grow"],[1,"edit__buttons","edit-buttons"],[1,"edit-buttons__button","edit-buttons__button-delete",3,"click"],[1,"edit-buttons__button",3,"click"],[1,"edit-teams__control"],[1,"edit-teams__input-wrap"],["type","text",1,"edit-teams__input",3,"formControl"],[1,"edit-teams__buttons"],[4,"ngIf","ngIfElse"],["addButton",""],[1,"edit-teams__button","edit-teams__delete",3,"click"],["src","assets/icons/delete.png","alt",""],["src","assets/icons/loader-button.svg"],[4,"ngIf"],[1,"edit-teams__button","edit-teams__ok",3,"click"],["src","assets/icons/ok.png"],[1,"edit-teams__button","edit-teams__cancel",3,"click"],[1,"edit-teams__button","edit-teams__ok","edit-teams__ok-add",3,"click"]],template:function(t,n){1&t&&(e.TgZ(0,"h1",0),e._uU(1," \u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435\n"),e.qZA(),e.TgZ(2,"form",1)(3,"div",2),e._UZ(4,"input",3),e.qZA(),e.TgZ(5,"div",4)(6,"div",5)(7,"div",6),e._uU(8," \u0414\u0430\u0442\u0430 "),e.qZA(),e.TgZ(9,"div",7)(10,"div",8),e._UZ(11,"input",9),e.qZA(),e.TgZ(12,"div",10),e._UZ(13,"input",11),e.qZA()()(),e.TgZ(14,"div",5)(15,"div",6),e._uU(16," \u0412\u0440\u0435\u043c\u044f \u0438\u0433\u0440\u044b "),e.qZA(),e.TgZ(17,"div",7)(18,"div",10),e._UZ(19,"input",12),e.qZA()()()(),e.TgZ(20,"div",13)(21,"button",14),e.NdJ("click",function(){return n.resetGame()}),e._uU(22," \u041e\u0442\u043c\u0435\u043d\u0430 "),e.qZA(),e.TgZ(23,"button",15),e.NdJ("click",function(){return n.updateGame()}),e._uU(24," \u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c "),e.qZA()()(),e.TgZ(25,"div",16)(26,"h2",17),e._uU(27," \u041a\u043e\u043c\u0430\u043d\u0434\u044b "),e.qZA(),e.TgZ(28,"ul",18),e.YNc(29,A,8,5,"ng-container",19),e.qZA()(),e._UZ(30,"div",20),e.TgZ(31,"div",21)(32,"button",22),e.NdJ("click",function(){return n.deleteGame()}),e._uU(33," \u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0438\u0433\u0440\u0443 "),e.qZA(),e.TgZ(34,"button",23),e.NdJ("click",function(){return n.startGame()}),e._uU(35," \u041d\u0430\u0447\u0430\u0442\u044c \u0438\u0433\u0440\u0443 "),e.qZA()()),2&t&&(e.xp6(2),e.Q6J("formGroup",n.gameForm)("@appear",void 0),e.xp6(2),e.Q6J("formControl",n.gameForm.controls.gameTitle)("ngClass",e.VKq(10,k,n.gameForm.controls.gameTitle.invalid&&n.gameForm.controls.gameTitle.touched)),e.xp6(6),e.Q6J("ngClass",e.VKq(12,k,n.gameForm.controls.date.invalid&&n.gameForm.controls.date.touched)),e.xp6(1),e.Q6J("formControl",n.gameForm.controls.date),e.xp6(2),e.Q6J("formControl",n.gameForm.controls.time),e.xp6(6),e.Q6J("formControl",n.gameForm.controls.timeGame),e.xp6(1),e.Q6J("ngClass",e.VKq(14,G,n.gameForm.disabled||n.disableGameForm)),e.xp6(9),e.Q6J("ngForOf",n.teamsControls.controls))},dependencies:[m.mk,m.sg,m.O5,s._Y,s.Fj,s.JJ,s.JL,s.oH,s.sg],styles:[".edit__form[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-top:6rem;align-items:center;width:100%}.edit__teams[_ngcontent-%COMP%]{margin-top:3.6rem}.edit__grow[_ngcontent-%COMP%]{flex-grow:1}.edit__buttons[_ngcontent-%COMP%]{margin-top:3rem}.edit-form__name[_ngcontent-%COMP%]{width:100%;max-width:1300px}.edit-form__name-input[_ngcontent-%COMP%]{width:100%;text-align:center;background-color:#f0f0f0;color:#000;font-size:2.5rem;padding:1rem;border-radius:11px;transition:all ease .3s;box-shadow:0 0 1px 1px transparent}.edit-form__name-input[_ngcontent-%COMP%]::placeholder{color:#9d9d9d}.edit-form__name-input[_ngcontent-%COMP%]:focus, .edit-form__name-input[_ngcontent-%COMP%]:active{box-shadow:0 0 1px 1px #000}.edit-form__name-input.invalid[_ngcontent-%COMP%]{box-shadow:0 0 1px 1px red}.edit-form__row[_ngcontent-%COMP%]{display:flex;margin-top:2rem;gap:4rem;flex-wrap:wrap;justify-content:center;align-items:center}.edit-form__field[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1.5rem}.edit-form__field-title[_ngcontent-%COMP%]{font-weight:700;font-size:2.3rem}.edit-form__date-row[_ngcontent-%COMP%]{display:flex;gap:1rem}.edit-form__input-wrap[_ngcontent-%COMP%]{position:relative;padding:7px 12px;background-color:#f0f0f0;border-radius:11px;width:193px;box-shadow:0 0 1px 1px #fff;transition:all ease .3s;overflow:hidden}.edit-form__input-wrap.time[_ngcontent-%COMP%]{width:114px}.edit-form__input-wrap.invalid[_ngcontent-%COMP%]{box-shadow:0 0 1px 1px red}.edit-form__input-date[_ngcontent-%COMP%]{font-family:Roboto Mono,monospace;font-size:26px;line-height:1;vertical-align:top;background-color:transparent;width:300px;font-weight:700;position:relative;top:50%;right:0%;transform:translateY(-50%);color:#3d8e4f}.edit-form__input-date[_ngcontent-%COMP%]::-webkit-inner-spin-button, .edit-form__input-date[_ngcontent-%COMP%]::-webkit-calendar-picker-indicator{position:fixed;left:-100%;top:-100%;padding-left:1000px;width:0;height:0;opacity:0;display:none}.edit-form__input-time[_ngcontent-%COMP%]{font-size:28px;font-family:Roboto Mono,monospace;line-height:1;background-color:transparent;width:300px;font-weight:700;color:#3290ff}.edit-form__button[_ngcontent-%COMP%]{padding:1rem 1.5rem;color:#fff;font-size:1.8rem;background-color:#3d8e4f;border-radius:11px;transition:all ease .3s}.edit-form__button[_ngcontent-%COMP%]:hover{background-color:#3d5e30}.edit-form__button-cancel[_ngcontent-%COMP%]{background-color:#3290ff}.edit-form__button-cancel[_ngcontent-%COMP%]:hover{background-color:#0069e5}.edit-form__buttons[_ngcontent-%COMP%]{margin-top:2rem;display:flex;gap:1.5rem}.edit-form__buttons.disabled[_ngcontent-%COMP%]   .edit-form__button[_ngcontent-%COMP%]{background-color:#d7d7d7;color:#000}.edit-teams[_ngcontent-%COMP%]{width:100%;max-width:1300px}.edit-teams__title[_ngcontent-%COMP%]{font-weight:700;font-size:2.3rem;text-align:center}.edit-teams__controls[_ngcontent-%COMP%]{width:100%;margin-top:2.5rem}.edit-teams__control[_ngcontent-%COMP%]{width:100%;margin-bottom:1.3rem;display:flex}.edit-teams__control[_ngcontent-%COMP%]:last-child{margin-bottom:0}.edit-teams__input-wrap[_ngcontent-%COMP%]{flex:0 0 55rem}.edit-teams__input[_ngcontent-%COMP%]{width:100%;background-color:#f0f0f0;color:#000;font-size:2rem;padding:1rem 1.5rem;border-radius:11px;transition:all ease .3s;box-shadow:0 0 1px 1px transparent}.edit-teams__input[_ngcontent-%COMP%]::placeholder{color:#9d9d9d}.edit-teams__input[_ngcontent-%COMP%]:focus, .edit-teams__input[_ngcontent-%COMP%]:active{box-shadow:0 0 1px 1px #000}.edit-teams__input.invalid[_ngcontent-%COMP%]{box-shadow:0 0 1px 1px red}.edit-teams__buttons[_ngcontent-%COMP%]{margin-left:1.8rem;display:flex}.edit-teams__button[_ngcontent-%COMP%]{margin-left:1rem;position:relative;height:100%;border-radius:11px;transition:all ease .3s}.edit-teams__button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);width:2rem;height:2rem;object-fit:contain;pointer-events:none;transition:all ease .3s}.edit-teams__button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]:last-child{opacity:0}.edit-teams__button.loading[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]:first-child{opacity:0}.edit-teams__button.loading[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]:last-child{opacity:1}.edit-teams__button.loading[_ngcontent-%COMP%] ~ .edit-teams__button[_ngcontent-%COMP%]{display:none}.edit-teams__delete[_ngcontent-%COMP%]{aspect-ratio:1;background-color:#da0303;margin-left:0}.edit-teams__delete[_ngcontent-%COMP%]:hover{background-color:#c60303}.edit-teams__ok[_ngcontent-%COMP%]{aspect-ratio:1;background-color:#68a153}.edit-teams__ok-add[_ngcontent-%COMP%]{margin-left:0}.edit-teams__ok[_ngcontent-%COMP%]:hover{background-color:#598947}.edit-teams__cancel[_ngcontent-%COMP%]{background-color:#3290ff;display:flex;align-items:center;justify-content:center;padding:0 1.5rem;font-size:2rem;color:#fff}.edit-teams__cancel[_ngcontent-%COMP%]:hover{background-color:#0074fe}.edit-buttons[_ngcontent-%COMP%]{display:flex;gap:1rem}.edit-buttons__button[_ngcontent-%COMP%]{padding:1rem 1.5rem;border-radius:11px;background-color:#68a153;color:#fff;font-size:1.5rem;transition:all ease .3s}.edit-buttons__button[_ngcontent-%COMP%]:hover{background-color:#598947}.edit-buttons__button-delete[_ngcontent-%COMP%]{background-color:#da0303}.edit-buttons__button-delete[_ngcontent-%COMP%]:hover{background-color:#c60303}"],data:{animation:[(0,c.X$)("appear",[(0,c.eR)(":enter",(0,c._7)(b.M))]),(0,c.X$)("leave",[(0,c.eR)(":leave",(0,c._7)(C.Z))])]}}),a})();var w=u(4763),J=u(2723),v=u(4207),I=u(7579);const y={0:{"-":"\u041d\u0435\u0442\u0440\u043e\u043d\u0443\u0442\u0430\u044f \u0437\u0430\u0434\u0430\u0447\u0430",0:"\u041d\u0435\u0432\u0435\u0440\u043d\u043e \u0440\u0435\u0448\u0451\u043d\u043d\u0430\u044f \u0437\u0430\u0434\u0430\u0447\u0430",1:"\u0412\u0435\u0440\u043d\u043e \u0440\u0435\u0448\u0451\u043d\u043d\u0430\u044f \u0437\u0430\u0434\u0430\u0447\u0430"},1:{"-":"\u041d\u0435\u0442\u0440\u043e\u043d\u0443\u0442\u0430\u044f \u0437\u0430\u0434\u0430\u0447\u0430",0:"\u041d\u0435\u0432\u0435\u0440\u043d\u043e \u0440\u0435\u0448\u0451\u043d\u043d\u0430\u044f \u0437\u0430\u0434\u0430\u0447\u0430",1:'\u0411\u043e\u043d\u0443\u0441 "+1" \u0434\u043b\u044f \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u043e\u0439 \u0437\u0430\u0434\u0430\u0447\u0438',2:'\u0411\u043e\u043d\u0443\u0441 "+2" \u0434\u043b\u044f \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u043e\u0439 \u0437\u0430\u0434\u0430\u0447\u0438',3:'\u0411\u043e\u043d\u0443\u0441 "+3" \u0434\u043b\u044f \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u043e\u0439 \u0437\u0430\u0434\u0430\u0447\u0438',4:'\u0411\u043e\u043d\u0443\u0441 "*2" \u0434\u043b\u044f \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u043e\u0439 \u0437\u0430\u0434\u0430\u0447\u0438',5:'\u0411\u043e\u043d\u0443\u0441 "*3" \u0434\u043b\u044f \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u043e\u0439 \u0437\u0430\u0434\u0430\u0447\u0438',6:'\u0411\u043e\u043d\u0443\u0441 "*4" \u0434\u043b\u044f \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u043e\u0439 \u0437\u0430\u0434\u0430\u0447\u0438'},2:{2:"\u041d\u0430 \u0437\u0430\u0434\u0430\u0447\u0443 \u043e\u0441\u0442\u0430\u043b\u043e\u0441\u044c 2 \u043f\u043e\u043f\u044b\u0442\u043a\u0438",1:"\u041d\u0430 \u0437\u0430\u0434\u0430\u0447\u0443 \u043e\u0441\u0442\u0430\u043b\u0430\u0441\u044c 1 \u043f\u043e\u043f\u044b\u0442\u043a\u0430",0:"\u041d\u0430 \u0437\u0430\u0434\u0430\u0447\u0443 \u043d\u0435 \u043e\u0441\u0442\u0430\u043b\u043e\u0441\u044c \u043f\u043e\u043f\u044b\u0442\u043e\u043a",\u04401:"\u0417\u0430\u0434\u0430\u0447\u0430 \u0440\u0435\u0448\u0435\u043d\u0430 \u0441 \u043f\u0435\u0440\u0432\u043e\u0439 \u043f\u043e\u043f\u044b\u0442\u043a\u0438",\u04402:"\u0417\u0430\u0434\u0430\u0447\u0430 \u0440\u0435\u0448\u0435\u043d\u0430 \u0441\u043e \u0432\u0442\u043e\u0440\u043e\u0439 \u043f\u043e\u043f\u044b\u0442\u043a\u0438"}},Q=["teamRef"],N=["sumRef"];function U(a,r){if(1&a){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",19),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.cancelUpdate())}),e._uU(2," \u041e\u0442\u043c\u0435\u043d\u0430 "),e.qZA(),e.TgZ(3,"button",20),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.updateScores())}),e._uU(4," \u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c "),e.qZA(),e.BQk()}2&a&&(e.xp6(1),e.Q6J("@appear",void 0)("@leave",void 0),e.xp6(2),e.Q6J("@appear",void 0)("@leave",void 0))}function B(a,r){if(1&a){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",21),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.changeStatus(2,"\u041f\u0440\u0438\u043e\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0438\u0433\u0440\u0443?"))}),e._uU(2," \u041f\u0440\u0438\u043e\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c "),e.qZA(),e.BQk()}2&a&&(e.xp6(1),e.Q6J("@appear",void 0)("@leave",void 0))}function q(a,r){if(1&a){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",22),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.changeStatus(1,"\u0412\u043e\u0437\u043e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0438\u0433\u0440\u0443?"))}),e._uU(2," \u0412\u043e\u0437\u043e\u0431\u043d\u043e\u0432\u0438\u0442\u044c "),e.qZA(),e.TgZ(3,"button",23),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.changeStatus(3,"\u0417\u0430\u043c\u043e\u0440\u043e\u0437\u0438\u0442\u044c \u0438\u0433\u0440\u0443?"))}),e._uU(4," \u0417\u0430\u043c\u043e\u0440\u043e\u0437\u0438\u0442\u044c "),e.qZA(),e.BQk()}2&a&&(e.xp6(1),e.Q6J("@appear",void 0)("@leave",void 0),e.xp6(2),e.Q6J("@appear",void 0)("@leave",void 0))}function D(a,r){if(1&a){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",21),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.changeStatus(2,"\u0420\u0430\u0437\u043c\u043e\u0440\u043e\u0437\u0438\u0442\u044c \u0438\u0433\u0440\u0443?"))}),e._uU(2," \u0420\u0430\u0437\u043c\u043e\u0440\u043e\u0437\u0438\u0442\u044c "),e.qZA(),e.TgZ(3,"button",19),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.changeStatus(4,"\u0417\u0430\u0432\u0435\u0440\u0448\u0438\u0442\u044c \u0438\u0433\u0440\u0443?"))}),e._uU(4," \u0417\u0430\u0432\u0435\u0440\u0448\u0438\u0442\u044c "),e.qZA(),e.BQk()}2&a&&(e.xp6(1),e.Q6J("@appear",void 0)("@leave",void 0),e.xp6(2),e.Q6J("@appear",void 0)("@leave",void 0))}function Y(a,r){if(1&a){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",19),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.deleteGame())}),e._uU(2," \u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0438\u0433\u0440\u0443 "),e.qZA(),e.TgZ(3,"div",24),e._uU(4," \u0417\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0430 "),e.qZA(),e.BQk()}2&a&&(e.xp6(1),e.Q6J("@appear",void 0)("@leave",void 0),e.xp6(2),e.Q6J("@appear",void 0)("@leave",void 0))}function z(a,r){if(1&a&&(e.ynx(0),e.TgZ(1,"div",25),e._uU(2),e.qZA(),e.BQk()),2&a){const t=r.$implicit;e.xp6(2),e.hij(" ",t," ")}}function j(a,r){if(1&a&&(e.ynx(0),e.TgZ(1,"div",30),e._UZ(2,"input",31),e.qZA(),e.BQk()),2&a){const t=r.$implicit;e.xp6(2),e.Q6J("formControl",t.controls.score)}}function $(a,r){if(1&a&&(e.ynx(0)(1,26),e.TgZ(2,"div",27)(3,"div",28,12),e._uU(5),e.qZA(),e.TgZ(6,"div",29,14),e._uU(8),e.qZA(),e.YNc(9,j,3,1,"ng-container",15),e.qZA(),e.BQk()()),2&a){const t=r.$implicit,n=r.index,o=e.oxw();e.xp6(1),e.Q6J("formGroup",t),e.xp6(4),e.hij(" ",o.game.teams[n].name," "),e.xp6(3),e.hij(" ",o.game.teams[n].sumScore," "),e.xp6(1),e.Q6J("ngForOf",t.controls.scores.controls)}}function H(a,r){if(1&a&&(e.ynx(0),e.TgZ(1,"div",32)(2,"div",33),e._uU(3),e.qZA(),e.TgZ(4,"div",34),e._uU(5),e.qZA()(),e.BQk()),2&a){const t=r.$implicit;e.xp6(3),e.hij(" ",t[0]," "),e.xp6(2),e.hij(" ",t[1]," ")}}let R=(()=>{class a{constructor(t,n,o,i){this._fb=t,this._destroy=n,this._confirmer=o,this._gamesService=i,this.changeStatusEvent=new e.vpe,this.deleteEvent=new e.vpe,this.toChange=[],this.desis=[],this.cancel=new I.x,this.GameExercises=w.E,this.OGameType=J.E}ngOnInit(){this.createScoresForm();for(let t of Object.keys(y[this.game.type]))this.desis.push([t,y[this.game.type][t]])}ngAfterViewInit(){let t=0;this.teamRef.forEach(n=>t=Math.max(t,n.nativeElement.getBoundingClientRect().width)),this.teamRef.forEach(n=>n.nativeElement.style.width=t+"px"),this.sumRef.forEach(n=>n.nativeElement.style.left=t+"px")}getTeamsGroups(){return this.teamsScoresForm.controls.teams.controls}createScoresForm(){this.teamsScoresForm=this._fb.group({teams:this._fb.array([])}),this.game.teams.forEach(t=>this.teamsScoresForm.controls.teams.push(this.createTeamGroup(t)))}createTeamGroup(t){let n=this._fb.group({scores:this._fb.array([])});for(let o=0;o<w.E.getCountExercises(this.game.type);o++)n.controls.scores.push(this.createScoreGroup(t,o));return n}createScoreGroup(t,n){let o=this._fb.group({score:new s.NI(v.R.convertResponse(t.scores[n],this.game.type,!0),{nonNullable:!0})});return this.changeSubscribe(o,t,n),o}changeSubscribe(t,n,o){let i=t.valueChanges.pipe(this._destroy.takeUntilDestroy).subscribe(_=>{this.valueChange(t,n,o,_.score??"");let l=this.cancel.pipe(this._destroy.takeUntilDestroy).subscribe(()=>{i.unsubscribe(),l.unsubscribe();let d=this.toChange.findIndex(h=>h.teamId==n.teamId&&h.exercise==o);-1!=d&&this.toChange.splice(d,1),t.controls.score.setValue(v.R.convertResponse(n.scores[o],this.game.type,!0)),setTimeout(()=>{this.changeSubscribe(t,n,o)},1e3)})})}valueChange(t,n,o,i){if(t.invalid)return;let _={teamId:n.teamId,exercise:o,value:i??""},l=this.toChange.findIndex(d=>d.teamId==n.teamId&&d.exercise==o);-1!=l&&this.toChange.splice(l,1),this.toChange.push(_)}updateScores(){let t={gameId:this.game.id,gameType:this.game.type,changeScores:this.toChange.map(n=>({teamId:n.teamId,exercise:n.exercise,value:v.R.convertToDb(n.value.toString(),this.game.type)}))};this._gamesService.changeScores(t).pipe((0,p.q)(1)).subscribe(),this.toChange=[]}cancelUpdate(){this.cancel.next(1)}changeStatus(t,n){this._confirmer.createConfirm(n).subscribe(o=>{!o||this.changeStatusEvent.emit(t)})}deleteGame(){this._confirmer.createConfirm("\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0438\u0433\u0440\u0443?").subscribe(t=>{!t||this.deleteEvent.emit(1)})}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(s.qu),e.Y36(g.z),e.Y36(T.z),e.Y36(x.B))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-after-started"]],viewQuery:function(t,n){if(1&t&&(e.Gf(Q,5),e.Gf(N,5)),2&t){let o;e.iGM(o=e.CRH())&&(n.teamRef=o),e.iGM(o=e.CRH())&&(n.sumRef=o)}},inputs:{game:"game"},outputs:{changeStatusEvent:"changeStatusEvent",deleteEvent:"deleteEvent"},features:[e._Bn([g.z])],decls:31,vars:10,consts:[[1,"after__wrapper"],[1,"after__name"],[1,"after__type"],[1,"after__row"],[1,"after__rest","after-rest"],[1,"after-rest__container"],[1,"after__buttons"],[4,"ngIf"],[1,"after__results-wrap"],[1,"after__results","after-results"],[1,"after-results__row","after-results__row-head"],[1,"after-results__team-head"],["teamRef",""],[1,"after-results__sum-head"],["sumRef",""],[4,"ngFor","ngForOf"],[1,"after-results__designations","after-designations"],[1,"after-designations__header"],[1,"after-designations__table"],[1,"after__button","after__button-stop",3,"click"],[1,"after__button","after__button-save",3,"click"],[1,"after__button","after__button-pause",3,"click"],[1,"after__button","after__button-ok",3,"click"],[1,"after__button","after__button-frozen",3,"click"],[1,"after__button","after__button-stop"],[1,"after-results__score-head"],[3,"formGroup"],[1,"after-results__row"],[1,"after-results__team"],[1,"after-results__sum"],[1,"after-results__score"],["type","text",1,"after-results__input",3,"formControl"],[1,"after-designations__row"],[1,"after-designations__key"],[1,"after-designations__value"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"h2",1),e._uU(2),e.TgZ(3,"div",2),e._uU(4),e.qZA()(),e.TgZ(5,"div",3)(6,"div",4)(7,"div",5),e._uU(8," 01:30:30 "),e.qZA()(),e.TgZ(9,"div",6),e.YNc(10,U,5,4,"ng-container",7),e.YNc(11,B,3,2,"ng-container",7),e.YNc(12,q,5,4,"ng-container",7),e.YNc(13,D,5,4,"ng-container",7),e.YNc(14,Y,5,4,"ng-container",7),e.qZA()(),e.TgZ(15,"div",8)(16,"div",9)(17,"div",10)(18,"div",11,12),e._uU(20," \u041a\u043e\u043c\u0430\u043d\u0434\u0430 "),e.qZA(),e.TgZ(21,"div",13,14),e._uU(23," \u0421\u0443\u043c\u043c\u0430 "),e.qZA(),e.YNc(24,z,3,1,"ng-container",15),e.qZA(),e.YNc(25,$,10,4,"ng-container",15),e.TgZ(26,"div",16)(27,"div",17),e._uU(28," \u041e\u0431\u043e\u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f "),e.qZA(),e.TgZ(29,"div",18),e.YNc(30,H,6,2,"ng-container",15),e.qZA()()()()()),2&t&&(e.xp6(2),e.hij(" ",n.game.name," "),e.xp6(2),e.hij(" / ",n.OGameType[n.game.type]," "),e.xp6(6),e.Q6J("ngIf",0!=n.toChange.length),e.xp6(1),e.Q6J("ngIf",1==n.game.status),e.xp6(1),e.Q6J("ngIf",2==n.game.status),e.xp6(1),e.Q6J("ngIf",3==n.game.status),e.xp6(1),e.Q6J("ngIf",4==n.game.status),e.xp6(10),e.Q6J("ngForOf",n.GameExercises.getExercises(n.game.type)),e.xp6(1),e.Q6J("ngForOf",n.getTeamsGroups()),e.xp6(5),e.Q6J("ngForOf",n.desis))},dependencies:[m.sg,m.O5,s.Fj,s.JJ,s.JL,s.oH,s.sg],styles:[".after__wrapper[_ngcontent-%COMP%]{padding:2rem 4.5rem;width:100%}.after__name[_ngcontent-%COMP%]{font-weight:700;font-size:1.6rem;display:flex;align-items:center;justify-content:center;gap:.7rem}.after__type[_ngcontent-%COMP%]{color:#6b6b6b}.after__row[_ngcontent-%COMP%]{margin-top:2rem;display:flex;align-items:center;justify-content:space-between}.after__rest[_ngcontent-%COMP%]{margin-left:15%}.after__buttons[_ngcontent-%COMP%]{display:flex;gap:1.2rem;justify-content:flex-end}.after__button[_ngcontent-%COMP%]{background-color:#000;color:#fff;padding:1.2rem 1.8rem;border-radius:11px;font-size:1.8rem;font-weight:700;transition:all ease .3s}.after__button-save[_ngcontent-%COMP%]{background-color:#454b7e}.after__button-ok[_ngcontent-%COMP%]{background-color:#68a153}.after__button-pause[_ngcontent-%COMP%]{background-color:#be8632}.after__button-frozen[_ngcontent-%COMP%]{background-color:#536ea1}.after__button-stop[_ngcontent-%COMP%]{background-color:#da0303}.after-rest[_ngcontent-%COMP%]{padding:.5rem .9rem;background-color:#f0f0f0;border-radius:11px}.after-rest__container[_ngcontent-%COMP%]{color:#3290ff;font-weight:700;font-size:2.5rem}.after__results-wrap[_ngcontent-%COMP%]{margin-top:2rem;width:100%;display:flex;justify-content:center;position:relative}.after__results[_ngcontent-%COMP%]{overflow-x:scroll;padding-bottom:1rem}.after-results__row[_ngcontent-%COMP%]{display:flex;width:-moz-fit-content;width:fit-content}.after-results__row-head[_ngcontent-%COMP%]{position:sticky;z-index:3;top:-3rem}.after-results__team-head[_ngcontent-%COMP%]{border:1px solid black;display:flex;justify-content:center;align-items:center;position:sticky;left:0;top:0;background-color:#e5e5e5;z-index:2;padding:.7rem}.after-results__sum-head[_ngcontent-%COMP%]{width:5rem;height:3rem;border:1px solid black;border-left:none;display:flex;justify-content:center;align-items:center;position:sticky;background-color:#e5e5e5;z-index:2}.after-results__score-head[_ngcontent-%COMP%]{width:3.5rem;height:3rem;border:1px solid black;border-left:none;display:flex;justify-content:center;align-items:center;background-color:#e5e5e5;position:sticky;top:0}.after-results__team[_ngcontent-%COMP%]{border:1px solid black;border-top:none;display:flex;justify-content:center;align-items:center;padding:.7rem;position:sticky;left:0;white-space:nowrap;background-color:#e5e5e5}.after-results__sum[_ngcontent-%COMP%]{width:5rem;height:3rem;text-align:center;border:1px solid black;border-top:none;border-left:none;display:flex;justify-content:center;align-items:center;position:sticky;background-color:#fff}.after-results__score[_ngcontent-%COMP%]{width:3.5rem;height:3rem}.after-results__input[_ngcontent-%COMP%]{width:3.5rem;height:3rem;border:1px solid black;border-top:none;border-left:none;text-align:center}.after-designations[_ngcontent-%COMP%]{position:absolute;margin-top:4rem;white-space:nowrap}.after-designations__header[_ngcontent-%COMP%]{padding:1rem;border:1px solid black;width:-moz-fit-content;width:fit-content;border-bottom:none}.after-designations__table[_ngcontent-%COMP%]{display:flex;flex-direction:column;border:1px solid black;border-right:none;border-bottom:none}.after-designations__row[_ngcontent-%COMP%]{display:flex;font-size:1rem;font-weight:500}.after-designations__key[_ngcontent-%COMP%]{width:3rem;min-height:3rem;display:flex;justify-content:center;align-items:center;border:1px solid black;border-left:none;border-top:none}.after-designations__value[_ngcontent-%COMP%]{min-height:3rem;display:flex;justify-content:center;align-items:center;width:100%;padding:1rem;border:1px solid black;border-left:none;border-top:none}"],data:{animation:[(0,c.X$)("appear",[(0,c.eR)(":enter",(0,c._7)(b.M))]),(0,c.X$)("leave",[(0,c.eR)(":leave",(0,c._7)(C.Z))])]}}),a})();function K(a,r){if(1&a){const t=e.EpF();e.TgZ(0,"app-before-started",6),e.NdJ("changeStatusEvent",function(o){e.CHM(t);const i=e.oxw(2);return e.KtG(i.changeGameStatus(o))})("deleteEvent",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.deleteGame())}),e.qZA()}if(2&a){const t=e.oxw(2);e.Q6J("game",t.game)("@appear",void 0)("@leave",void 0)}}function V(a,r){if(1&a){const t=e.EpF();e.TgZ(0,"app-after-started",7),e.NdJ("changeStatusEvent",function(o){e.CHM(t);const i=e.oxw(2);return e.KtG(i.changeGameStatus(o))})("deleteEvent",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.deleteGame())}),e.qZA()}if(2&a){const t=e.oxw(2);e.Q6J("game",t.game)("@appear",void 0)("@leave",void 0)}}function X(a,r){if(1&a&&(e.ynx(0),e.YNc(1,K,1,3,"app-before-started",4),e.YNc(2,V,1,3,"app-after-started",5),e.BQk()),2&a){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",0==t.game.status),e.xp6(1),e.Q6J("ngIf",0!=t.game.status)}}function L(a,r){1&a&&(e.TgZ(0,"div",8),e._UZ(1,"img",9),e.qZA()),2&a&&e.Q6J("@appear",void 0)}let W=(()=>{class a{constructor(t,n,o,i){this._router=t,this._gamesService=n,this._destroy=o,this._fb=i}ngOnInit(){let t=this._router.getCurrentNavigation()?.extras.state;t?this.game=t:this._gamesService.getGameById(parseInt(this._router.url.split("/").reverse()[0])).pipe(this._destroy.takeUntilDestroy).subscribe(n=>{this.game=n})}changeGameStatus(t){let n=this.game?.id??0;this.game=null,this._gamesService.updateGameStatus({gameId:n,status:t}).pipe((0,p.q)(1)).subscribe(o=>{setTimeout(()=>this.game=o,300)})}deleteGame(){this._gamesService.deleteGame({gameId:this.game?.id??0}).pipe((0,p.q)(1)).subscribe(()=>this._router.navigate([""])),this.game=null}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(f.F0),e.Y36(x.B),e.Y36(g.z),e.Y36(s.qu))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-edit-page"]],features:[e._Bn([g.z])],decls:6,vars:3,consts:[[1,"edit"],[1,"edit__wrapper"],[4,"ngIf","ngIfElse"],["loading",""],["class","edit__before",3,"game","changeStatusEvent","deleteEvent",4,"ngIf"],["class","edit__after",3,"game","changeStatusEvent","deleteEvent",4,"ngIf"],[1,"edit__before",3,"game","changeStatusEvent","deleteEvent"],[1,"edit__after",3,"game","changeStatusEvent","deleteEvent"],[1,"loader"],["src","assets/icons/loader-black.svg","alt",""]],template:function(t,n){if(1&t&&(e.TgZ(0,"section",0),e._UZ(1,"app-back-to-main"),e.TgZ(2,"div",1),e.YNc(3,X,3,2,"ng-container",2),e.YNc(4,L,2,1,"ng-template",null,3,e.W1O),e.qZA()()),2&t){const o=e.MAs(5);e.Q6J("@appear",void 0),e.xp6(3),e.Q6J("ngIf",n.game)("ngIfElse",o)}},dependencies:[m.O5,O.q,F,R],styles:[".edit[_ngcontent-%COMP%]{min-height:100vh;background-color:#fff;display:flex;flex-direction:column}.edit__wrapper[_ngcontent-%COMP%]{flex-grow:1;display:flex;flex-direction:column;align-items:center;height:100%}.edit__before[_ngcontent-%COMP%]{flex-grow:1;display:flex;flex-direction:column;align-items:center;height:100%;width:100%;padding:4.3rem 1.5rem 2rem}.edit__after[_ngcontent-%COMP%]{width:100%}"],data:{animation:[(0,c.X$)("appear",[(0,c.eR)(":enter",(0,c._7)(b.M))]),(0,c.X$)("leave",[(0,c.eR)(":leave",(0,c._7)(C.Z))])]}}),a})();var ee=u(4466);const te=[{path:"",component:W}];let ne=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[m.ez,f.Bz.forChild(te),ee.m,s.u5,s.UX,f.Bz]}),a})()}}]);